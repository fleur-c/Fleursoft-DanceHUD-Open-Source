// This work is licensed under a Creative Commons Attribution 3.0 Unported License (http://creativecommons.org/licenses/by/3.0/)
list e=["ALL","FEMALE","MALE","LEAD","LEFT","CENTER","RIGHT","GROUP1","GROUP2","GROUP3","GROUP4","GROUP5"];list ad=[1,2,4,8,16,32,64,128,256,512,1024,2048];list ab=["|","|","|","|","|","|","|","|","|","|","|","|"];list af=["|","ALIAS","DANCE","DELAY","DIALOG","END","GIVE","GROUP","IM","LOOP","MENU","MENUSTYLE","MESSAGE","MIX","NAME","NEXTSEQUENCE","OWNER_SAY","RAND","RANDOM","REGION_SAY","REPEAT","SAY","SETNAME","SHOUT","STOP","STYLE","WHISPER","ZZZDEFER"];list aq=[0,12,1032,1042,1032,128,1032,76,1032,65,2057,2057,1561,65,8,1288,1032,1074,65,1561,1280,1561,1032,1561,1280,8,1561,5128];integer M;string y="";key O="00000000-0000-0000-0000-000000000000";integer b;integer u=1;integer U;integer ag;integer H;integer l=1;list w;list Y;string W="";integer r;list ae;list i;integer aa;integer V=1;integer m;integer v;integer ac;integer D;list L;string J;list g=["0","1","2","3","4","5","6","7","8","9"];
at(string ao,list t){llMessageLinked(-4,12123405,ao,llDumpList2String(t,"|"));}
as(){ab=[];for(b=0;b<(ad!=[]);++b){ab=ab+"|";}for(b=0;b<10;++b){ae=ae+"|";}}
au(integer ak,string z){if (r&-!(ak==3)){w=w+"3|-1";}if (~llListFindList([5,24,20],(list)ak)){w=w+(string)ak;}else{w=w+((string)ak+"|"+z);}if (14==ak|W==""&2==ak){W=z;}if (ak==2){++H;}r=ak==2;}
integer B(string ap){integer j;list x;if (i==[]){J=(string)D+"|"+(string)(~-(w!=[]))+"|"+(string)H;i=i+J;return 1;}x=llParseString2List(llList2String(i,0),(list)"|",[]);j=llList2Integer(x,0);if (D^7){if (~llListFindList([9,13,18],(list)j)){at("NCMSG020",[b,ap]);return 0;}if (0<aa){at("NCMSG022",[b,ap]);return 0;}++aa;}else{if (j==7){at("NCMSG021",[b,ap]);return 0;}}J=(string)D+"|"+(string)(~-(w!=[]))+"|"+(string)H;i=i+J;return 1;}
integer Q(string f){list q;integer j;integer c;integer d;integer K=i!=[];if (!K){at("NCMSG028",[(string)b,f]);return 0;}q=llParseString2List(llList2String(i,-1),(list)"|",[]);j=llList2Integer(q,0);if (j^7){if (j^9){J=llList2String(af,j);j=llList2Integer(q,2);c=llList2Integer(q,1);d=llList2Integer(llParseString2List(llList2String(w,c),(list)"|",[]),1);if (H+-j<d){at("NCMSG029",[(string)b,f,J,d,H+-j]);q=llParseString2List(llList2String(w,c),(list)"|",[]);q=llListReplaceList(q,(list)(H+-j),1,1);J=llDumpList2String(q,"|");w=llListReplaceList(w,(list)J,c,c);}}}else{aa=0;}if (1<K){i=(list)llList2String(i,0);}else{i=[];}return 1;}
integer am(string I){integer j;integer c;if (D==2){J=llList2String(L,0);if (V&-!(20==llGetInventoryType(J))){if (!~llListFindList(Y,(list)J))Y=Y+J;if (99<(Y!=[])){Y=llListSort(Y,1,1);at("NCMSG032",(list)((string)(Y!=[])));at("NCMSG005b",(list)llDumpList2String(Y,","));Y=[];}at("NCMSG014",[b,I,J]);return 1;}return 1;}if (D==10){u=llList2Integer(L,0);llMessageLinked(-4,305410560+u,"108|"+llList2String(L,1),"");return 1;}if (!~-D){J=llList2String(L,0);j=llListFindList(e,(list)J);if (j<1){at(llList2String(["NCMSG012","NCMSG25"],-~j),[b,I]);return 0;}L=L+j;j=~-llList2Integer(L,1);J=llList2String(L,2);ab=llListReplaceList(ab,(list)J,j,j);return 1;}if (D==7){string n=llToUpper(llList2String(L,0));if (!~llListFindList(["SAME","DIFFERENT"],(list)n)){at("NCMSG011",[b,I]);return 0;}J=llStringTrim(llGetSubString(I,llSubStringIndex(I,llList2String(L,1)),-1),3);j=llListFindList(e,(list)llToUpper(J));if (!~j){j=llListFindList(ab,(list)llToUpper(J));if (!~j){at("NCMSG016",[b,I,J]);return 0;}}L=[n,llList2Integer(ad,j),J,llList2String(e,j)];aa=0;return 1;}if (D==9){j=llList2Integer(L,0);if (j<2){at("NCMSG023",[(string)b,I,j]);return 0;}if (10<j){at("NCMSG024",[(string)b,I,j,10]);return 0;}return 1;}if (D==11){j=llList2Integer(L,0);J=llToUpper(llList2String(L,1));c=llListFindList(ae,(list)J);if ((~c)&-!(c==(~-j))){ae=llListReplaceList(ae,(list)"|",c,c);}ae=llListReplaceList(ae,(list)J,~-j,~-j);return 1;}if (D==4){j=llParseString2List(llList2String(L,0),(list)",",[])!=[];if (j<3){at("NCMSG015",[b,I]);return 0;}return 1;}if (D==25){J=llToUpper(llList2String(L,0));j=llListFindList(ae,(list)J);if (~j){u=-~j;}else{j=llListFindList(ae,(list)"|");if (~j){ae=llListReplaceList(ae,(list)J,j,j);u=-~j;at("NCMSG027",[b,u,J]);}else{at("NCMSG030",[b,I,u,J]);}}return 1;}return 1;}
integer ah(string P){list N;list ai;integer k;integer j;integer c;float a;string X;if (20==llGetInventoryType(P)){au(2,P);return 1;}N=llParseString2List(P,["[","]"],[]);ai=llParseString2List(llStringTrim(llList2String(N,0),3),[" ",",",":"],[]);X=llStringTrim(llList2String(ai,0),3);D=llListFindList(af,(list)llToUpper(X));if (!~D){at("NCMSG007",[b,P]);return 0;}k=llList2Integer(aq,D);if (k&4096){at("NCMSG007",[b,P]);return 0;}j=ai!=[];L=[];if (k&1){if (1<j){c=(integer)llStringTrim(llList2String(ai,1),3);if (c<0&(!((k&512)==512))){at("NCMSG008",[b,P]);return 0;}if (!(c|(~llListFindList(g,(list)llGetSubString(llStringTrim(llList2String(ai,1),3),0,0))))){at("NCMSG009",[b,P]);return 0;}if (!(k&2048^2048|0<c&c<11)){at("NCMSG026",[b,P,c,10]);return 0;}}else{c=llList2Integer([0,0,0,0,0,0,0,0,0,2,u,u,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0],D);}L=(list)c;}if (k&2){a=(float)llStringTrim(llList2String(ai,1),3);if (a<0.1){at("NCMSG010",[b,P]);return 0;}if (a==0.&(!~llListFindList(g,(list)llGetSubString(llStringTrim(llList2String(ai,1),3),0,0)))){at("NCMSG010",[b,P]);return 0;}L=(list)((integer)(a*10.));if (2<j&(k&32)==32){a=(float)llStringTrim(llList2String(ai,2),3);if (a<0.1){at("NCMSG010",[b,P]);return 0;}if (a==0.&(!~llListFindList(g,(list)llGetSubString(llStringTrim(llList2String(ai,2),3),0,0)))){at("NCMSG010",[b,P]);return 0;}L=L+(integer)(a*10.);}}if (k&4){if (D==7){if (1<j){L=(list)llToUpper(llStringTrim(llList2String(ai,1),3));}else{L=(list)"SAME";}}if (!~-D){if (1<j){L=(list)llToUpper(llStringTrim(llList2String(ai,1),3));}else{at("NCMSG013",[b,P]);return 0;}}}if (k&8){J=llStringTrim(llList2String(N,1),3);if (1<(N!=[])){L=L+J;}else{J=llList2String(af,D);at("NCMSG017",[b,P,J]);return 0;}}if (!am(P)){return 0;}au(D,llDumpList2String(L,"|"));if (k&64){if (!B(P)){w=llDeleteSubList(w,-1,-1);}}if (k&128){if (!Q(P)){w=llDeleteSubList(w,-1,-1);}}j=0;if (k&256){j=1;}return j;}
ar(string an){integer al;string C;list S;integer aj;integer p=llStringLength(an);integer F;integer o;S=llParseStringKeepNulls(an,(list)"|",[]);an="";F=S!=[];for(al=0;al<F&(!o);++al){C=llStringTrim(llList2String(S,al),3);if (!(C=="")){if (llGetSubString(C,0,0)=="["){o=ah(C);}else{if (20^llGetInventoryType(C)){aj=(integer)((float)C*10.);if (aj){if (aj<0){at("NCMSG008",[b,C]);}else{au(3,(string)aj);}}else{au(2,C);if (V&-!~llListFindList(Y,(list)C)){Y=Y+C;if (99<(Y!=[])){Y=llListSort(Y,1,1);at("NCMSG032",(list)((string)(Y!=[])));at("NCMSG005b",(list)llDumpList2String(Y,","));Y=[];}}if (!(al^(~-F)|p^255)){at("NCMSG006",[(string)b,C]);}}}else{au(2,C);}}}}if (o&-(al<F)){at("NCMSG019",[b,C]);}if (l){if (r){au(3,"-1");}aj=i!=[];if (0<aj){for(al=0;al<aj;++al){ah("[END]");}}al=w!=[];if (0<al){if (W==""){W="Sequence "+(string)(++ag);}if (2==al){S=llParseString2List(llList2String(w,0),(list)"|",[]);if (llList2Integer(S,0)==2){S=llParseString2List(llList2String(w,1),(list)"|",[]);if (!(llList2Integer(S,0)^3|(~llList2Integer(S,1)))){w=w+20;}}}llMessageLinked(-4,305410560+u,"101|"+W,llDumpList2String(w,"|||"));if (ac){llMessageLinked(-4,12123408,"2",(string)(305410560+u));}++U;}else{if (m){llMessageLinked(-4,305410560+u,"110","");}}}}
default{
state_entry(){as();}
changed(integer s){if (s&128)llResetScript();}
link_message(integer E,integer Z,string h,key G){if ((!Z)&h=="RESET")llResetScript();if (12123401==Z){list A;A=llParseString2List(h,(list)"|",[]);if (llToUpper(llList2String(A,0))=="LOAD"){u=-305410560+llList2Integer(A,2);ac=0;if (M){at("NCMSG001",[y,llList2String(A,1)]);}else{y=llList2String(A,1);if (llGetInventoryType(y)^7){at("NCMSG003",(list)y);}else{if (llGetSubString(y,0,2)=="~FS"){at("NCMSG033",(list)y);return;}M=1;at("NCMSG002",[y,u]);U=0;l=1;b=0;O=llGetNotecardLine(y,b);}}return;}if (llToUpper(llList2String(A,0))=="REMEMBER"){if (M){at("NCMSG001",[y,llList2String(A,1)]);}else{W="";w=[];H=0;r=0;U=0;l=1;y="";u=-305410560+llList2Integer(A,1);ac=1;ar(G);}return;}if (llToUpper(llList2String(A,0))=="REDIRECT"){u=-305410560+llList2Integer(A,1);return;}if (llToUpper(llList2String(A,0))=="MISSING"){V=llList2Integer(A,1);return;}if (llToUpper(llList2String(A,0))=="BLANK"){m=llList2Integer(A,1);return;}if (llToUpper(llList2String(A,0))=="COMMENT"){v=llList2Integer(A,1);return;}if (llToUpper(llList2String(A,0))=="ALIASES"){D=(integer)((string)G);J=llDumpList2String(ab,",");llMessageLinked(-4,D,"ALIASES",(key)J);J="";return;}}}
dataserver(key R,string T){if (R==O){if (!(T=="\n\n\n")){++b;if (!(b%50)){at("NCMSG031",(list)b);}if (T==""){if (m){llMessageLinked(-4,305410560+u,"110","");}}else{if (llGetSubString(T,0,0)=="#"){if (v&-(1<llStringLength(T))){llMessageLinked(-4,305410560+u,"111",llGetSubString(T,1,-1));}}else{if (l){W="";w=[];H=0;r=0;}l=1;if (llGetSubString(T,-1,-1)=="\\"){l=0;T=llGetSubString(T,0,-2);}ar(T);}}O=llGetNotecardLine(y,b);return;}if (0<(Y!=[])){Y=llListSort(Y,1,1);at("NCMSG005",(list)((string)(Y!=[])));at("NCMSG005b",(list)llDumpList2String(Y,","));}at("NCMSG004",[y,(string)U]);llMessageLinked(-4,12123408,"LOADED",y);J=llDumpList2String(ab,",");llMessageLinked(-4,303181825,"ALIASES",(key)J);J="";M=0;}}
}// lsl script: ~FSRead  optimized at:Thu Sep  5 21:04:52 2019
